{"version":3,"sources":["../../../src/researches/findTransitionWords.js"],"names":["paper","locale","getLocale","transitionWords","sentences","getText","sentenceResults","checkSentencesForTransitionWords","totalSentences","length","transitionWordSentences","regexFromDoubleArray","regexFromDoubleArrayCacheKey","getRegexFromDoubleArray","twoPartTransitionWords","cacheKey","join","matchTwoPartTransitionWords","sentence","twoPartTransitionWordsRegex","match","matchTransitionWords","filter","word","results","forEach","twoPartMatches","push","transitionWordMatches"],"mappings":";;;;;;kBAiGe,UAAUA,KAAV,EAAkB;AAChC,KAAMC,SAASD,MAAME,SAAN,EAAf;AACA,KAAMC,kBAAkB,kCAAoBF,MAApB,CAAxB;AACA,KAAMG,YAAY,4BAAcJ,MAAMK,OAAN,EAAd,CAAlB;AACA,KAAMC,kBAAkBC,iCAAkCH,SAAlC,EAA6CD,eAA7C,CAAxB;;AAEA,QAAO;AACNK,kBAAgBJ,UAAUK,MADpB;AAENH,mBAAiBA,eAFX;AAGNI,2BAAyBJ,gBAAgBG;AAHnC,EAAP;AAKA,C;;AA5GD;;;;AACA;;;;AACA;;AACA;;;;AACA;;AAEA;;;;AAEA,IAAIE,uBAAuB,IAA3B;AACA,IAAIC,+BAA+B,EAAnC;;AAEA;;;;;;;AAOA,SAASC,uBAAT,CAAkCC,sBAAlC,EAA2D;AAC1D,KAAMC,WAAW,2BAAaD,sBAAb,EAAsCE,IAAtC,CAA4C,EAA5C,CAAjB;AACA,KAAKJ,iCAAiCG,QAAjC,IAA6CJ,yBAAyB,IAA3E,EAAkF;AACjFC,iCAA+BG,QAA/B;AACAJ,yBAAuB,0CAA4BG,sBAA5B,CAAvB;AACA;AACD,QAAOH,oBAAP;AACA;;AAED;;;;;;;AAOA,IAAMM,8BAA8B,SAA9BA,2BAA8B,CAAUC,QAAV,EAAoBJ,sBAApB,EAA6C;AAChFI,YAAW,6BAAuBA,QAAvB,CAAX;AACA,KAAMC,8BAA8BN,wBAAyBC,sBAAzB,CAApC;AACA,QAAOI,SAASE,KAAT,CAAgBD,2BAAhB,CAAP;AACA,CAJD;;AAMA;;;;;;;AAOA,IAAME,uBAAuB,SAAvBA,oBAAuB,CAAUH,QAAV,EAAoBf,eAApB,EAAsC;AAClEe,YAAW,6BAAuBA,QAAvB,CAAX;AACA,QAAOf,gBAAgBmB,MAAhB,CAAwB;AAAA,SAAQ,2CAAqBC,IAArB,EAA2BL,QAA3B,CAAR;AAAA,EAAxB,CAAP;AACA,CAHD;;AAKA;;;;;;;AAOA,IAAMX,mCAAmC,SAAnCA,gCAAmC,CAAUH,SAAV,EAAqBD,eAArB,EAAuC;AAC/E,KAAMqB,UAAU,EAAhB;;AAEApB,WAAUqB,OAAV,CAAmB,oBAAY;AAC9B,MAAMC,iBAAiBT,4BAA6BC,QAA7B,EAAuCf,gBAAgBW,sBAAhB,EAAvC,CAAvB;;AAEA,MAAKY,mBAAmB,IAAxB,EAA+B;AAC9BF,WAAQG,IAAR,CAAc;AACbT,cAAUA,QADG;AAEbf,qBAAiBuB;AAFJ,IAAd;;AAKA;AACA;;AAED,MAAME,wBAAwBP,qBAAsBH,QAAtB,EAAgCf,gBAAgBA,eAAhD,CAA9B;;AAEA,MAAKyB,sBAAsBnB,MAAtB,KAAiC,CAAtC,EAA0C;AACzCe,WAAQG,IAAR,CAAc;AACbT,cAAUA,QADG;AAEbf,qBAAiByB;AAFJ,IAAd;;AAKA;AACA;AACD,EAtBD;;AAwBA,QAAOJ,OAAP;AACA,CA5BD;;AA8BA","file":"findTransitionWords.js","sourcesContent":["import createRegexFromDoubleArray from \"../stringProcessing/createRegexFromDoubleArray.js\";\nimport getSentences from \"../stringProcessing/getSentences.js\";\nimport { normalizeSingle as normalizeSingleQuotes } from \"../stringProcessing/quotes.js\";\nimport getTransitionWords from \"../helpers/getTransitionWords.js\";\nimport { isWordInSentence as matchWordInSentence } from \"../stringProcessing/matchWordInSentence.js\";\n\nimport { flattenDeep } from \"lodash-es\";\n\nlet regexFromDoubleArray = null;\nlet regexFromDoubleArrayCacheKey = \"\";\n\n/**\n * Memoizes the createRegexFromDoubleArray with the twoPartTransitionWords.\n *\n * @param {Array} twoPartTransitionWords The array containing two-part transition words.\n *\n * @returns {RegExp} The RegExp to match text with a double array.\n */\nfunction getRegexFromDoubleArray( twoPartTransitionWords ) {\n\tconst cacheKey = flattenDeep( twoPartTransitionWords ).join( \"\" );\n\tif ( regexFromDoubleArrayCacheKey !== cacheKey || regexFromDoubleArray === null ) {\n\t\tregexFromDoubleArrayCacheKey = cacheKey;\n\t\tregexFromDoubleArray = createRegexFromDoubleArray( twoPartTransitionWords );\n\t}\n\treturn regexFromDoubleArray;\n}\n\n/**\n * Matches the sentence against two part transition words.\n *\n * @param {string} sentence The sentence to match against.\n * @param {Array} twoPartTransitionWords The array containing two-part transition words.\n * @returns {Array} The found transitional words.\n */\nconst matchTwoPartTransitionWords = function( sentence, twoPartTransitionWords ) {\n\tsentence = normalizeSingleQuotes( sentence );\n\tconst twoPartTransitionWordsRegex = getRegexFromDoubleArray( twoPartTransitionWords );\n\treturn sentence.match( twoPartTransitionWordsRegex );\n};\n\n/**\n * Matches the sentence against transition words.\n *\n * @param {string} sentence The sentence to match against.\n * @param {Array} transitionWords The array containing transition words.\n * @returns {Array} The found transitional words.\n */\nconst matchTransitionWords = function( sentence, transitionWords ) {\n\tsentence = normalizeSingleQuotes( sentence );\n\treturn transitionWords.filter( word => matchWordInSentence( word, sentence ) );\n};\n\n/**\n * Checks the passed sentences to see if they contain transition words.\n *\n * @param {Array} sentences The sentences to match against.\n * @param {Object} transitionWords The object containing both transition words and two part transition words.\n * @returns {Array} Array of sentence objects containing the complete sentence and the transition words.\n */\nconst checkSentencesForTransitionWords = function( sentences, transitionWords ) {\n\tconst results = [];\n\n\tsentences.forEach( sentence => {\n\t\tconst twoPartMatches = matchTwoPartTransitionWords( sentence, transitionWords.twoPartTransitionWords() );\n\n\t\tif ( twoPartMatches !== null ) {\n\t\t\tresults.push( {\n\t\t\t\tsentence: sentence,\n\t\t\t\ttransitionWords: twoPartMatches,\n\t\t\t} );\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst transitionWordMatches = matchTransitionWords( sentence, transitionWords.transitionWords );\n\n\t\tif ( transitionWordMatches.length !== 0 ) {\n\t\t\tresults.push( {\n\t\t\t\tsentence: sentence,\n\t\t\t\ttransitionWords: transitionWordMatches,\n\t\t\t} );\n\n\t\t\treturn;\n\t\t}\n\t} );\n\n\treturn results;\n};\n\n/**\n * Checks how many sentences from a text contain at least one transition word or two-part transition word\n * that are defined in the transition words config and two part transition words config.\n *\n * @param {Paper} paper The Paper object to get text from.\n * @returns {object} An object with the total number of sentences in the text\n * and the total number of sentences containing one or more transition words.\n */\nexport default function( paper ) {\n\tconst locale = paper.getLocale();\n\tconst transitionWords = getTransitionWords( locale );\n\tconst sentences = getSentences( paper.getText() );\n\tconst sentenceResults = checkSentencesForTransitionWords( sentences, transitionWords );\n\n\treturn {\n\t\ttotalSentences: sentences.length,\n\t\tsentenceResults: sentenceResults,\n\t\ttransitionWordSentences: sentenceResults.length,\n\t};\n}\n"]}