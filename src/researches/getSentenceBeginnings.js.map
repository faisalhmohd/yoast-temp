{"version":3,"sources":["../../../src/researches/getSentenceBeginnings.js"],"names":["paper","researcher","sentences","getResearch","firstWordExceptions","getLocale","sentenceBeginnings","map","sentence","getSentenceBeginning","filter","length","compareFirstWords","startsWithSameWord","currentSentenceBeginning","nextSentenceBeginning","consecutiveFirstWords","foundSentences","sameBeginnings","beginning","i","push","word","count","words","firstWord","toLocaleLowerCase","indexOf"],"mappings":";;;;;;kBAmFe,UAAUA,KAAV,EAAiBC,UAAjB,EAA8B;AAC5C,KAAIC,YAAYD,WAAWE,WAAX,CAAwB,WAAxB,CAAhB;AACA,KAAMC,sBAAsB,sCAAwBJ,MAAMK,SAAN,EAAxB,GAA5B;;AAEA,KAAIC,qBAAqBJ,UAAUK,GAAV,CAAe,UAAUC,QAAV,EAAqB;AAC5D,SAAOC,qBAAsBD,QAAtB,EAAgCJ,mBAAhC,CAAP;AACA,EAFwB,CAAzB;;AAIAF,aAAYA,UAAUQ,MAAV,CAAkB,UAAUF,QAAV,EAAqB;AAClD,SAAO,wBAAU,2BAAaA,QAAb,CAAV,EAAoCG,MAApC,GAA6C,CAApD;AACA,EAFW,CAAZ;AAGAL,sBAAqB,sBAAQA,kBAAR,CAArB;;AAEA,QAAOM,kBAAmBN,kBAAnB,EAAuCJ,SAAvC,CAAP;AACA,C;;AAjGD;;;;AACA;;;;AACA;;;;AACA;;AAEA;;;;AAIA;;;;;;;AAOA,IAAMW,qBAAqB,SAArBA,kBAAqB,CAAUC,wBAAV,EAAoCC,qBAApC,EAA4D;AACtF,KAAK,CAAE,uBAASD,wBAAT,CAAF,IAAyCA,6BAA6BC,qBAA3E,EAAmG;AAClG,SAAO,IAAP;AACA;;AAED,QAAO,KAAP;AACA,CAND;;AAQA;;;;;;;AAOA,IAAMH,oBAAoB,SAApBA,iBAAoB,CAAUN,kBAAV,EAA8BJ,SAA9B,EAA0C;AACnE,KAAMc,wBAAwB,EAA9B;AACA,KAAIC,iBAAiB,EAArB;AACA,KAAIC,iBAAiB,CAArB;;AAEA,wBAASZ,kBAAT,EAA6B,UAAUa,SAAV,EAAqBC,CAArB,EAAyB;AACrD,MAAMN,2BAA2BK,SAAjC;AACA,MAAMJ,wBAAwBT,mBAAoBc,IAAI,CAAxB,CAA9B;AACAH,iBAAeI,IAAf,CAAqBnB,UAAWkB,CAAX,CAArB;;AAEA,MAAKP,mBAAoBC,wBAApB,EAA8CC,qBAA9C,CAAL,EAA6E;AAC5EG;AACA,GAFD,MAEO;AACNF,yBAAsBK,IAAtB,CAA4B,EAAEC,MAAMR,wBAAR,EAAkCS,OAAOL,cAAzC,EAAyDhB,WAAWe,cAApE,EAA5B;AACAC,oBAAiB,CAAjB;AACAD,oBAAiB,EAAjB;AACA;AACD,EAZD;;AAcA,QAAOD,qBAAP;AACA,CApBD;;AAsBA;;;;;;;AAOA,SAASP,oBAAT,CAA+BD,QAA/B,EAAyCJ,mBAAzC,EAA+D;AAC9D,KAAMoB,QAAQ,wBAAU,kCAAW,2BAAahB,QAAb,CAAX,CAAV,CAAd;;AAEA,KAAKgB,MAAMb,MAAN,KAAiB,CAAtB,EAA0B;AACzB,SAAO,EAAP;AACA;;AAED,KAAIc,YAAYD,MAAO,CAAP,EAAWE,iBAAX,EAAhB;;AAEA,KAAKtB,oBAAoBuB,OAApB,CAA6BF,SAA7B,IAA2C,CAAC,CAA5C,IAAiDD,MAAMb,MAAN,GAAe,CAArE,EAAyE;AACxEc,eAAa,MAAMD,MAAO,CAAP,CAAnB;AACA;;AAED,QAAOC,SAAP;AACA;;AAED","file":"getSentenceBeginnings.js","sourcesContent":["import getWords from \"../stringProcessing/getWords.js\";\nimport stripSpaces from \"../stringProcessing/stripSpaces.js\";\nimport getFirstWordExceptions from \"../helpers/getFirstWordExceptions.js\";\nimport { stripFullTags as stripTags } from \"../stringProcessing/stripHTMLTags.js\";\n\nimport { isEmpty } from \"lodash-es\";\nimport { forEach } from \"lodash-es\";\nimport { filter } from \"lodash-es\";\n\n/**\n * Compares the first word of each sentence with the first word of the following sentence.\n *\n * @param {string} currentSentenceBeginning The first word of the current sentence.\n * @param {string} nextSentenceBeginning The first word of the next sentence.\n * @returns {boolean} Returns true if sentence beginnings match.\n */\nconst startsWithSameWord = function( currentSentenceBeginning, nextSentenceBeginning ) {\n\tif ( ! isEmpty( currentSentenceBeginning ) && currentSentenceBeginning === nextSentenceBeginning ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\n/**\n * Counts the number of similar sentence beginnings.\n *\n * @param {Array} sentenceBeginnings The array containing the first word of each sentence.\n * @param {Array} sentences The array containing all sentences.\n * @returns {Array} The array containing the objects containing the first words and the corresponding counts.\n */\nconst compareFirstWords = function( sentenceBeginnings, sentences ) {\n\tconst consecutiveFirstWords = [];\n\tlet foundSentences = [];\n\tlet sameBeginnings = 1;\n\n\tforEach( sentenceBeginnings, function( beginning, i ) {\n\t\tconst currentSentenceBeginning = beginning;\n\t\tconst nextSentenceBeginning = sentenceBeginnings[ i + 1 ];\n\t\tfoundSentences.push( sentences[ i ] );\n\n\t\tif ( startsWithSameWord( currentSentenceBeginning, nextSentenceBeginning ) ) {\n\t\t\tsameBeginnings++;\n\t\t} else {\n\t\t\tconsecutiveFirstWords.push( { word: currentSentenceBeginning, count: sameBeginnings, sentences: foundSentences } );\n\t\t\tsameBeginnings = 1;\n\t\t\tfoundSentences = [];\n\t\t}\n\t} );\n\n\treturn consecutiveFirstWords;\n};\n\n/**\n * Retrieves the first word from the sentence.\n *\n * @param {string} sentence The sentence to retrieve the first word from.\n * @param {Array} firstWordExceptions Exceptions to match against.\n * @returns {string} The first word of the sentence.\n */\nfunction getSentenceBeginning( sentence, firstWordExceptions ) {\n\tconst words = getWords( stripTags( stripSpaces( sentence ) ) );\n\n\tif ( words.length === 0 ) {\n\t\treturn \"\";\n\t}\n\n\tlet firstWord = words[ 0 ].toLocaleLowerCase();\n\n\tif ( firstWordExceptions.indexOf( firstWord ) > -1 && words.length > 1 ) {\n\t\tfirstWord += \" \" + words[ 1 ];\n\t}\n\n\treturn firstWord;\n}\n\n/**\n * Gets the first word of each sentence from the text, and returns an object containing the first word of each sentence and the corresponding counts.\n *\n * @param {Paper} paper The Paper object to get the text from.\n * @param {Researcher} researcher The researcher this research is a part of.\n * @returns {Object} The object containing the first word of each sentence and the corresponding counts.\n */\nexport default function( paper, researcher ) {\n\tlet sentences = researcher.getResearch( \"sentences\" );\n\tconst firstWordExceptions = getFirstWordExceptions( paper.getLocale() )();\n\n\tlet sentenceBeginnings = sentences.map( function( sentence ) {\n\t\treturn getSentenceBeginning( sentence, firstWordExceptions );\n\t} );\n\n\tsentences = sentences.filter( function( sentence ) {\n\t\treturn getWords( stripSpaces( sentence ) ).length > 0;\n\t} );\n\tsentenceBeginnings = filter( sentenceBeginnings );\n\n\treturn compareFirstWords( sentenceBeginnings, sentences );\n}\n\n\n"]}