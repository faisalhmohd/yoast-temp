{"version":3,"sources":["../../src/snippetPreview.js"],"names":["snippetEditorTemplate","snippetEditor","hiddenElement","hiddenSpan","defaults","data","title","metaDesc","urlPath","titleWidth","metaHeight","placeholder","defaultValue","baseURL","callbacks","saveSnippetData","addTrailingSlash","metaDescriptionDate","previewMode","titleMaxLength","maximumMetaDescriptionLength","maxMeta","inputPreviewBindings","preview","inputField","getBaseURL","opts","hasApp","refObj","rawData","baseUrl","retrieveUnformattedText","key","updateUnformattedText","value","element","input","hasTrailingSlash","url","indexOf","length","hasProgressSupport","progressElement","document","createElement","max","rateTitleLength","titleLength","rating","rateMetaDescLength","metaDescLength","updateProgressBar","maximum","barElement","progress","allClasses","removeClasses","addClass","getElementsByClassName","style","width","SnippetPreview","analyzerApp","i18n","snippetTitle","snippetCite","snippetMeta","metaTitle","targetElement","Error","_currentFocus","_currentHover","unformattedText","Object","defineProperty","get","bind","set","prototype","renderTemplate","innerHTML","raw","meta","rendered","formatTitle","formatUrl","formatCite","formatMeta","edit","dgettext","slug","metaDescription","save","snippetPreview","titleLabel","slugLabel","metaDescriptionLabel","snippetPreviewDescription","desktopPreviewMode","mobilePreviewMode","isScrollableHint","measurers","getElementById","urlBase","container","formContainer","editToggle","closeEditor","formFields","label","parentNode","initPreviewToggler","setInitialView","opened","createMeasurementElements","updateProgressBars","snippetPreviewToggle","initialize","bindEvents","refresh","output","htmlOutput","renderOutput","renderSnippetStyle","measureTitle","measureMetaDescription","getAnalyzerTitle","hasPluggable","pluggable","_applyModifications","getAnalyzerMetaDesc","getAnalyzerData","call","callRegisteredEventBinder","bindElementEvents","init","cite","html","loaded","replace","keyword","formatKeywordUrl","getMetaText","substring","formatKeyword","metaText","excerpt","text","getIndexMatches","indexMatches","i","match","push","getPeriodMatches","periodMatches","textString","keywordRegex","str","transliterateKeyword","locale","dashedKeyword","metaDescElement","removeClass","reRender","checkTextLength","event","currentTarget","textContent","id","className","YoastSEO","app","snippet_meta","snippet_title","getUnformattedText","currentElement","setUnformattedText","elem","validateFields","metaDescriptionRating","titleRating","previewWidth","getBoundingClientRect","setVisibility","handleWindowResizing","setScrollHintVisibility","elems","addEventListener","changedInput","toggleEditor","window","binding","previewElement","inputElement","openEditor","focus","_updateFocusCarets","_updateHoverCarets","updateDataFromDOM","setAttribute","focusedLabel","focusedPreview","hoveredLabel","setTitle","setUrlPath","setMetaDescription","metaDescriptionElement","spanHolder","offsetWidth","whiteSpace","body","appendChild","childNodes","metaHeightElement","offsetHeight","getTitleWidth","setTitleWidth","disableEnter","ev","textFeedback","showEditIcon","hideEditIcon","setFocus"],"mappings":"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","file":"snippetPreview.js","sourcesContent":["import { isEmpty } from \"lodash-es\";\nimport { isElement } from \"lodash-es\";\nimport { isUndefined } from \"lodash-es\";\nimport { clone } from \"lodash-es\";\nimport { defaultsDeep } from \"lodash-es\";\nimport { forEach } from \"lodash-es\";\nimport { debounce } from \"lodash-es\";\n\nimport createWordRegex from \"./stringProcessing/createWordRegex.js\";\nimport { stripFullTags as stripHTMLTags } from \"./stringProcessing/stripHTMLTags.js\";\nimport stripSpaces from \"./stringProcessing/stripSpaces.js\";\nimport replaceDiacritics from \"./stringProcessing/replaceDiacritics.js\";\nimport transliterate from \"./stringProcessing/transliterate.js\";\nimport templates from \"./templates.js\";\nvar snippetEditorTemplate = templates.snippetEditor;\nvar hiddenElement = templates.hiddenSpan;\n\nimport SnippetPreviewToggler from \"./snippetPreviewToggler\";\nimport domManipulation from \"./helpers/domManipulation.js\";\n\nimport Config from \"./config/config\";\n\nvar defaults = {\n\tdata: {\n\t\ttitle: \"\",\n\t\tmetaDesc: \"\",\n\t\turlPath: \"\",\n\t\ttitleWidth: 0,\n\t\tmetaHeight: 0,\n\t},\n\tplaceholder: {\n\t\ttitle: \"This is an example title - edit by clicking here\",\n\t\tmetaDesc: \"Modify your meta description by editing it right here\",\n\t\turlPath: \"example-post/\",\n\t},\n\tdefaultValue: {\n\t\ttitle: \"\",\n\t\tmetaDesc: \"\",\n\t},\n\tbaseURL: \"http://example.com/\",\n\tcallbacks: {\n\t\tsaveSnippetData: function() {},\n\t},\n\taddTrailingSlash: true,\n\tmetaDescriptionDate: \"\",\n\tpreviewMode: \"desktop\",\n\n};\n\nvar titleMaxLength = 600;\nconst maximumMetaDescriptionLength = Config.maxMeta;\n\nvar inputPreviewBindings = [\n\t{\n\t\tpreview: \"title_container\",\n\t\tinputField: \"title\",\n\t},\n\t{\n\t\tpreview: \"url_container\",\n\t\tinputField: \"urlPath\",\n\t},\n\t{\n\t\tpreview: \"meta_container\",\n\t\tinputField: \"metaDesc\",\n\t},\n];\n\n/**\n * Get's the base URL for this instance of the Snippet Preview.\n *\n * @private\n * @this SnippetPreview\n *\n * @returns {string} The base URL.\n */\nvar getBaseURL = function() {\n\tvar baseURL = this.opts.baseURL;\n\n\t/*\n\t * For backwards compatibility, if no URL was passed to the snippet editor we try to retrieve the base URL from the\n\t * rawData in the App. This is because the scrapers used to be responsible for retrieving the baseURL, but the base\n\t * URL is static so we can just pass it to the snippet editor.\n\t */\n\tif ( this.hasApp() && ! isEmpty( this.refObj.rawData.baseUrl ) && this.opts.baseURL === defaults.baseURL ) {\n\t\tbaseURL = this.refObj.rawData.baseUrl;\n\t}\n\n\treturn baseURL;\n};\n\n/**\n * Retrieves unformatted text from the data object\n *\n * @private\n * @this SnippetPreview\n *\n * @param {string} key The key to retrieve.\n *\n * @returns {string} The unformatted text.\n */\nfunction retrieveUnformattedText( key ) {\n\treturn this.data[ key ];\n}\n\n/**\n * Update data and DOM objects when the unformatted text is updated, here for backwards compatibility\n *\n * @private\n * @this SnippetPreview\n *\n * @param {string} key The data key to update.\n * @param {string} value The value to update.\n *\n * @returns {void}\n */\nfunction updateUnformattedText( key, value ) {\n\tthis.element.input[ key ].value = value;\n\n\tthis.data[ key ] = value;\n}\n\n/**\n * Returns if a url has a trailing slash or not.\n *\n * @param {string} url The url to check for a trailing slash.\n *\n * @returns {boolean} Whether or not the url contains a trailing slash.\n */\nfunction hasTrailingSlash( url ) {\n\treturn url.indexOf( \"/\" ) === ( url.length - 1 );\n}\n\n/**\n * Detects if this browser has <progress> support. Also serves as a poor man's HTML5shiv.\n *\n * @private\n *\n * @returns {boolean} Whether or not the browser supports a <progress> element\n */\nfunction hasProgressSupport() {\n\tvar progressElement = document.createElement( \"progress\" );\n\n\treturn ! isUndefined( progressElement.max );\n}\n\n/**\n * Returns a rating based on the length of the title\n *\n * @param {number} titleLength the length of the title.\n *\n * @returns {string} The rating given based on the title length.\n */\nfunction rateTitleLength( titleLength ) {\n\tvar rating;\n\n\tswitch ( true ) {\n\t\tcase titleLength > 0 && titleLength <= 399:\n\t\tcase titleLength > 600:\n\t\t\trating = \"ok\";\n\t\t\tbreak;\n\n\t\tcase titleLength >= 400 && titleLength <= 600:\n\t\t\trating = \"good\";\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\trating = \"bad\";\n\t\t\tbreak;\n\t}\n\n\treturn rating;\n}\n\n/**\n * Returns a rating based on the length of the meta description\n *\n * @param {number} metaDescLength the length of the meta description.\n *\n * @returns {string} The rating given based on the description length.\n */\nfunction rateMetaDescLength( metaDescLength ) {\n\tvar rating;\n\n\tswitch ( true ) {\n\t\tcase metaDescLength > 0 && metaDescLength < 120:\n\t\tcase metaDescLength > maximumMetaDescriptionLength:\n\t\t\trating = \"ok\";\n\t\t\tbreak;\n\n\t\tcase metaDescLength >= 120 && metaDescLength <= maximumMetaDescriptionLength:\n\t\t\trating = \"good\";\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\trating = \"bad\";\n\t\t\tbreak;\n\t}\n\n\treturn rating;\n}\n\n/**\n * Updates a progress bar\n *\n * @private\n * @this SnippetPreview\n *\n * @param {HTMLElement} element The progress element that's rendered.\n * @param {number} value The current value.\n * @param {number} maximum The maximum allowed value.\n * @param {string} rating The SEO score rating for this value.\n *\n * @returns {void}\n */\nfunction updateProgressBar( element, value, maximum, rating ) {\n\tvar barElement, progress,\n\t\tallClasses = [\n\t\t\t\"snippet-editor__progress--bad\",\n\t\t\t\"snippet-editor__progress--ok\",\n\t\t\t\"snippet-editor__progress--good\",\n\t\t];\n\n\telement.value = value;\n\tdomManipulation.removeClasses( element, allClasses );\n\tdomManipulation.addClass( element, \"snippet-editor__progress--\" + rating );\n\n\tif ( ! this.hasProgressSupport ) {\n\t\tbarElement = element.getElementsByClassName( \"snippet-editor__progress-bar\" )[ 0 ];\n\t\tprogress = ( value / maximum ) * 100;\n\n\t\tbarElement.style.width = progress + \"%\";\n\t}\n}\n\n/**\n * @module snippetPreview\n */\n\n/**\n * Defines the config and outputTarget for the SnippetPreview\n *\n * @param {Object}         opts                           - Snippet preview options.\n * @param {App}            opts.analyzerApp               - The app object the Snippet Preview is part of.\n * @param {Object}         opts.placeholder               - The placeholder values for the fields, will be shown as\n * actual placeholders in the inputs and as a fallback for the preview.\n * @param {string}         opts.placeholder.title         - The placeholder title.\n * @param {string}         opts.placeholder.metaDesc      - The placeholder meta description.\n * @param {string}         opts.placeholder.urlPath       - The placeholder url.\n *\n * @param {Object}         opts.defaultValue              - The default value for the fields, if the user has not\n * changed a field, this value will be used for the analyzer, preview and the progress bars.\n * @param {string}         opts.defaultValue.title        - The default title.\n * @param {string}         opts.defaultValue.metaDesc     - The default meta description.\n * it.\n *\n * @param {string}         opts.baseURL                   - The basic URL as it will be displayed in google.\n * @param {HTMLElement}    opts.targetElement             - The target element that contains this snippet editor.\n *\n * @param {Object}         opts.callbacks                 - Functions that are called on specific instances.\n * @param {Function}       opts.callbacks.saveSnippetData - Function called when the snippet data is changed.\n *\n * @param {boolean}        opts.addTrailingSlash          - Whether or not to add a trailing slash to the URL.\n * @param {string}         opts.metaDescriptionDate       - The date to display before the meta description.\n *\n * @param {Jed}            opts.i18n                      - The translation object.\n *\n * @param {string}         opts.previewMode               - The current preview mode.\n *\n * @property {App}         refObj                         - The connected app object.\n * @property {Jed}         i18n                           - The translation object.\n *\n * @property {HTMLElement} targetElement                  - The target element that contains this snippet editor.\n *\n * @property {Object}      element                        - The elements for this snippet editor.\n * @property {Object}      element.rendered               - The rendered elements.\n * @property {HTMLElement} element.rendered.title         - The rendered title element.\n * @property {HTMLElement} element.rendered.urlPath       - The rendered url path element.\n * @property {HTMLElement} element.rendered.urlBase       - The rendered url base element.\n * @property {HTMLElement} element.rendered.metaDesc      - The rendered meta description element.\n *\n * @property {HTMLElement} element.measurers.titleWidth   - The rendered title width element.\n * @property {HTMLElement} element.measurers.metaHeight   - The rendered meta height element.\n *\n * @property {Object}      element.input                  - The input elements.\n * @property {HTMLElement} element.input.title            - The title input element.\n * @property {HTMLElement} element.input.urlPath          - The url path input element.\n * @property {HTMLElement} element.input.metaDesc         - The meta description input element.\n *\n * @property {HTMLElement} element.container              - The main container element.\n * @property {HTMLElement} element.formContainer          - The form container element.\n * @property {HTMLElement} element.editToggle             - The button that toggles the editor form.\n *\n * @property {Object}      data                           - The data for this snippet editor.\n * @property {string}      data.title                     - The title.\n * @property {string}      data.urlPath                   - The url path.\n * @property {string}      data.metaDesc                  - The meta description.\n * @property {int}         data.titleWidth                - The width of the title in pixels.\n * @property {int}         data.metaHeight                - The height of the meta description in pixels.\n *\n * @property {string}      baseURL                        - The basic URL as it will be displayed in google.\n *\n * @property {boolean}     hasProgressSupport             - Whether this browser supports the <progress> element.\n *\n * @constructor\n */\nvar SnippetPreview = function( opts ) {\n\tdefaultsDeep( opts, defaults );\n\n\tthis.data = opts.data;\n\n\tif ( ! isUndefined( opts.analyzerApp ) ) {\n\t\tthis.refObj = opts.analyzerApp;\n\t\tthis.i18n = this.refObj.i18n;\n\n\t\tthis.data = {\n\t\t\ttitle: this.refObj.rawData.snippetTitle || \"\",\n\t\t\turlPath: this.refObj.rawData.snippetCite || \"\",\n\t\t\tmetaDesc: this.refObj.rawData.snippetMeta || \"\",\n\t\t};\n\n\t\t// For backwards compatibility set the metaTitle as placeholder.\n\t\tif ( ! isEmpty( this.refObj.rawData.metaTitle ) ) {\n\t\t\topts.placeholder.title = this.refObj.rawData.metaTitle;\n\t\t}\n\t}\n\n\tif ( ! isUndefined( opts.i18n ) ) {\n\t\tthis.i18n = opts.i18n;\n\t}\n\n\tif ( ! isElement( opts.targetElement ) ) {\n\t\tthrow new Error( \"The snippet preview requires a valid target element\" );\n\t}\n\n\tthis.opts = opts;\n\tthis._currentFocus = null;\n\tthis._currentHover = null;\n\n\t// For backwards compatibility monitor the unformatted text for changes and reflect them in the preview\n\tthis.unformattedText = {};\n\tObject.defineProperty( this.unformattedText, \"snippet_cite\", {\n\t\tget: retrieveUnformattedText.bind( this, \"urlPath\" ),\n\t\tset: updateUnformattedText.bind( this, \"urlPath\" ),\n\t} );\n\tObject.defineProperty( this.unformattedText, \"snippet_meta\", {\n\t\tget: retrieveUnformattedText.bind( this, \"metaDesc\" ),\n\t\tset: updateUnformattedText.bind( this, \"metaDesc\" ),\n\t} );\n\tObject.defineProperty( this.unformattedText, \"snippet_title\", {\n\t\tget: retrieveUnformattedText.bind( this, \"title\" ),\n\t\tset: updateUnformattedText.bind( this, \"title\" ),\n\t} );\n};\n\n/**\n * Renders snippet editor and adds it to the targetElement\n * @returns {void}\n */\nSnippetPreview.prototype.renderTemplate = function() {\n\tvar targetElement = this.opts.targetElement;\n\n\ttargetElement.innerHTML = snippetEditorTemplate( {\n\t\traw: {\n\t\t\ttitle: this.data.title,\n\t\t\tsnippetCite: this.data.urlPath,\n\t\t\tmeta: this.data.metaDesc,\n\t\t},\n\t\trendered: {\n\t\t\ttitle: this.formatTitle(),\n\t\t\tbaseUrl: this.formatUrl(),\n\t\t\tsnippetCite: this.formatCite(),\n\t\t\tmeta: this.formatMeta(),\n\t\t},\n\t\tmetaDescriptionDate: this.opts.metaDescriptionDate,\n\t\tplaceholder: this.opts.placeholder,\n\t\ti18n: {\n\t\t\tedit: this.i18n.dgettext( \"js-text-analysis\", \"Edit snippet\" ),\n\t\t\ttitle: this.i18n.dgettext( \"js-text-analysis\", \"SEO title\" ),\n\t\t\tslug: this.i18n.dgettext( \"js-text-analysis\", \"Slug\" ),\n\t\t\tmetaDescription: this.i18n.dgettext( \"js-text-analysis\", \"Meta description\" ),\n\t\t\tsave: this.i18n.dgettext( \"js-text-analysis\", \"Close snippet editor\" ),\n\t\t\tsnippetPreview: this.i18n.dgettext( \"js-text-analysis\", \"Snippet preview\" ),\n\t\t\ttitleLabel: this.i18n.dgettext( \"js-text-analysis\", \"SEO title preview:\" ),\n\t\t\tslugLabel: this.i18n.dgettext( \"js-text-analysis\", \"Slug preview:\" ),\n\t\t\tmetaDescriptionLabel: this.i18n.dgettext( \"js-text-analysis\", \"Meta description preview:\" ),\n\t\t\tsnippetPreviewDescription: this.i18n.dgettext(\n\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\"You can click on each element in the preview to jump to the Snippet Editor.\"\n\t\t\t),\n\t\t\tdesktopPreviewMode: this.i18n.dgettext( \"js-text-analysis\", \"Desktop preview\" ),\n\t\t\tmobilePreviewMode: this.i18n.dgettext( \"js-text-analysis\", \"Mobile preview\" ),\n\t\t\tisScrollableHint: this.i18n.dgettext( \"js-text-analysis\", \"Scroll to see the preview content.\" ),\n\t\t},\n\t} );\n\n\tthis.element = {\n\t\tmeasurers: {\n\t\t\tmetaHeight: null,\n\t\t},\n\t\trendered: {\n\t\t\ttitle: document.getElementById( \"snippet_title\" ),\n\t\t\turlBase: document.getElementById( \"snippet_citeBase\" ),\n\t\t\turlPath: document.getElementById( \"snippet_cite\" ),\n\t\t\tmetaDesc: document.getElementById( \"snippet_meta\" ),\n\t\t},\n\t\tinput: {\n\t\t\ttitle: targetElement.getElementsByClassName( \"js-snippet-editor-title\" )[ 0 ],\n\t\t\turlPath: targetElement.getElementsByClassName( \"js-snippet-editor-slug\" )[ 0 ],\n\t\t\tmetaDesc: targetElement.getElementsByClassName( \"js-snippet-editor-meta-description\" )[ 0 ],\n\t\t},\n\t\tprogress: {\n\t\t\ttitle: targetElement.getElementsByClassName( \"snippet-editor__progress-title\" )[ 0 ],\n\t\t\tmetaDesc: targetElement.getElementsByClassName( \"snippet-editor__progress-meta-description\" )[ 0 ],\n\t\t},\n\t\tcontainer: document.getElementById( \"snippet_preview\" ),\n\t\tformContainer: targetElement.getElementsByClassName( \"snippet-editor__form\" )[ 0 ],\n\t\teditToggle: targetElement.getElementsByClassName( \"snippet-editor__edit-button\" )[ 0 ],\n\t\tcloseEditor: targetElement.getElementsByClassName( \"snippet-editor__submit\" )[ 0 ],\n\t\tformFields: targetElement.getElementsByClassName( \"snippet-editor__form-field\" ),\n\t};\n\n\tthis.element.label = {\n\t\ttitle: this.element.input.title.parentNode,\n\t\turlPath: this.element.input.urlPath.parentNode,\n\t\tmetaDesc: this.element.input.metaDesc.parentNode,\n\t};\n\n\tthis.element.preview = {\n\t\ttitle: this.element.rendered.title.parentNode,\n\t\turlPath: this.element.rendered.urlPath.parentNode,\n\t\tmetaDesc: this.element.rendered.metaDesc.parentNode,\n\t};\n\n\tthis.hasProgressSupport = hasProgressSupport();\n\n\tif ( this.hasProgressSupport ) {\n\t\tthis.element.progress.title.max = titleMaxLength;\n\t\tthis.element.progress.metaDesc.max = maximumMetaDescriptionLength;\n\t} else {\n\t\tforEach( this.element.progress, function( progressElement ) {\n\t\t\tdomManipulation.addClass( progressElement, \"snippet-editor__progress--fallback\" );\n\t\t} );\n\t}\n\n\tthis.initPreviewToggler();\n\tthis.setInitialView();\n\n\tthis.opened = false;\n\tthis.createMeasurementElements();\n\tthis.updateProgressBars();\n};\n\n/**\n * Initializes the Snippet Preview Toggler.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.initPreviewToggler = function() {\n\tthis.snippetPreviewToggle = new SnippetPreviewToggler(\n\t\tthis.opts.previewMode, this.opts.targetElement.getElementsByClassName( \"snippet-editor__view-icon\" )\n\t);\n\tthis.snippetPreviewToggle.initialize();\n\tthis.snippetPreviewToggle.bindEvents();\n};\n\n/**\n * Refreshes the snippet editor rendered HTML\n * @returns {void}\n */\nSnippetPreview.prototype.refresh = function() {\n\tthis.output = this.htmlOutput();\n\tthis.renderOutput();\n\tthis.renderSnippetStyle();\n\tthis.measureTitle();\n\tthis.measureMetaDescription();\n\tthis.updateProgressBars();\n};\n\n/**\n * Returns the title as meant for the analyzer\n *\n * @private\n * @this SnippetPreview\n *\n * @returns {string} The title that is meant for the analyzer.\n */\nfunction getAnalyzerTitle() {\n\tvar title = this.data.title;\n\n\tif ( isEmpty( title ) ) {\n\t\ttitle = this.opts.defaultValue.title;\n\t}\n\n\tif ( this.hasPluggable() ) {\n\t\ttitle = this.refObj.pluggable._applyModifications( \"data_page_title\", title );\n\t}\n\n\treturn stripSpaces( title );\n}\n\n/**\n * Returns the metaDescription, includes the date if it is set.\n *\n * @private\n * @this SnippetPreview\n *\n * @returns {string} The meta data for the analyzer.\n */\nvar getAnalyzerMetaDesc = function() {\n\tvar metaDesc = this.data.metaDesc;\n\n\tif ( isEmpty( metaDesc ) ) {\n\t\tmetaDesc = this.opts.defaultValue.metaDesc;\n\t}\n\n\tif ( this.hasPluggable() ) {\n\t\tmetaDesc = this.refObj.pluggable._applyModifications( \"data_meta_desc\", metaDesc );\n\t}\n\n\tif ( ! isEmpty( this.opts.metaDescriptionDate ) && ! isEmpty( metaDesc ) ) {\n\t\tmetaDesc = this.opts.metaDescriptionDate + \" - \" + this.data.metaDesc;\n\t}\n\n\treturn stripSpaces( metaDesc );\n};\n\n/**\n * Returns the data from the Snippet Preview.\n *\n * @returns {Object} The collected data for the analyzer.\n */\nSnippetPreview.prototype.getAnalyzerData = function() {\n\treturn {\n\t\ttitle: getAnalyzerTitle.call( this ),\n\t\turl: this.data.urlPath,\n\t\tmetaDesc: getAnalyzerMetaDesc.call( this ),\n\t};\n};\n\n/**\n * Calls the event binder that has been registered using the callbacks option in the arguments of the App.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.callRegisteredEventBinder = function() {\n\tif ( this.hasApp() ) {\n\t\tthis.refObj.callbacks.bindElementEvents( this.refObj );\n\t}\n};\n\n/**\n *  Checks if title and url are set so they can be rendered in the Snippet Preview.\n *\n *  @returns {void}\n */\nSnippetPreview.prototype.init = function() {\n\tif (\n\t\tthis.hasApp() &&\n\t\tthis.refObj.rawData.metaTitle !== null &&\n\t\tthis.refObj.rawData.cite !== null\n\t) {\n\t\tthis.refresh();\n\t}\n};\n\n/**\n * Creates html object to contain the strings for the Snippet Preview.\n *\n * @returns {Object} The HTML output of the collected data.\n */\nSnippetPreview.prototype.htmlOutput = function() {\n\tvar html = {};\n\thtml.title = this.formatTitle();\n\thtml.cite = this.formatCite();\n\thtml.meta = this.formatMeta();\n\thtml.url = this.formatUrl();\n\treturn html;\n};\n\n/**\n * Formats the title for the Snippet Preview. If title and pageTitle are empty, sampletext is used.\n *\n * @returns {string} The correctly formatted title.\n */\nSnippetPreview.prototype.formatTitle = function() {\n\tvar title = this.data.title;\n\n\t// Fallback to the default if the title is empty.\n\tif ( isEmpty( title ) ) {\n\t\ttitle = this.opts.defaultValue.title;\n\t}\n\n\t// For rendering we can fallback to the placeholder as well.\n\tif ( isEmpty( title ) ) {\n\t\ttitle = this.opts.placeholder.title;\n\t}\n\n\t// Apply modification to the title before showing it.\n\tif ( this.hasPluggable() && this.refObj.pluggable.loaded ) {\n\t\ttitle = this.refObj.pluggable._applyModifications( \"data_page_title\", title );\n\t}\n\n\ttitle = stripHTMLTags( title );\n\n\t// As an ultimate fallback provide the user with a helpful message.\n\tif ( isEmpty( title ) ) {\n\t\ttitle = this.i18n.dgettext( \"js-text-analysis\", \"Please provide an SEO title by editing the snippet below.\" );\n\t}\n\n\treturn title;\n};\n\n/**\n * Formats the base url for the Snippet Preview. Removes the protocol name from the URL.\n *\n * @returns {string} Formatted base url for the Snippet Preview.\n */\nSnippetPreview.prototype.formatUrl = function() {\n\tvar url = getBaseURL.call( this );\n\n\t// Removes the http part of the url, google displays https:// if the website supports it.\n\treturn url.replace( /http:\\/\\//ig, \"\" );\n};\n\n/**\n * Formats the url for the Snippet Preview.\n *\n * @returns {string} Formatted URL for the Snippet Preview.\n */\nSnippetPreview.prototype.formatCite = function() {\n\tvar cite = this.data.urlPath;\n\n\tcite = replaceDiacritics( stripHTMLTags( cite ) );\n\n\t// Fallback to the default if the cite is empty.\n\tif ( isEmpty( cite ) ) {\n\t\tcite = this.opts.placeholder.urlPath;\n\t}\n\n\tif ( this.hasApp() && ! isEmpty( this.refObj.rawData.keyword ) ) {\n\t\tcite = this.formatKeywordUrl( cite );\n\t}\n\n\tif ( this.opts.addTrailingSlash && ! hasTrailingSlash( cite ) ) {\n\t\tcite = cite + \"/\";\n\t}\n\n\t// URL's cannot contain whitespace so replace it by dashes.\n\tcite = cite.replace( /\\s/g, \"-\" );\n\t// Strip out question mark and hash characters from the raw URL.\n\tcite = cite.replace( /\\?|#/g, \"\" );\n\n\treturn cite;\n};\n\n/**\n * Formats the meta description for the Snippet Preview, if it's empty retrieves it using getMetaText.\n *\n * @returns {string} Formatted meta description.\n */\nSnippetPreview.prototype.formatMeta = function() {\n\tvar meta = this.data.metaDesc;\n\n\t// If no meta has been set, generate one.\n\tif ( isEmpty( meta ) ) {\n\t\tmeta = this.getMetaText();\n\t}\n\n\t// Apply modification to the desc before showing it.\n\tif ( this.hasPluggable() && this.refObj.pluggable.loaded ) {\n\t\tmeta = this.refObj.pluggable._applyModifications( \"data_meta_desc\", meta );\n\t}\n\n\tmeta = stripHTMLTags( meta );\n\n\t// Cut-off the meta description according to the maximum length\n\tmeta = meta.substring( 0, maximumMetaDescriptionLength );\n\n\tif ( this.hasApp() && ! isEmpty( this.refObj.rawData.keyword ) ) {\n\t\tmeta = this.formatKeyword( meta );\n\t}\n\n\t// As an ultimate fallback provide the user with a helpful message.\n\tif ( isEmpty( meta ) ) {\n\t\tmeta = this.i18n.dgettext( \"js-text-analysis\", \"Please provide a meta description by editing the snippet below.\" );\n\t}\n\n\treturn meta;\n};\n\n/**\n * Generates a meta description with an educated guess based on the passed text and excerpt.\n * It uses the keyword to select an appropriate part of the text. If the keyword isn't present it takes the maximum\n * meta description length of the text. If both the keyword, text and excerpt are empty this function returns the\n * sample text.\n *\n * @returns {string} A generated meta description.\n */\nSnippetPreview.prototype.getMetaText = function() {\n\tvar metaText = this.opts.defaultValue.metaDesc;\n\n\tif ( this.hasApp() && ! isUndefined( this.refObj.rawData.excerpt ) && isEmpty( metaText ) ) {\n\t\tmetaText = this.refObj.rawData.excerpt;\n\t}\n\n\tif ( this.hasApp() && ! isUndefined( this.refObj.rawData.text ) && isEmpty( metaText ) ) {\n\t\tmetaText = this.refObj.rawData.text;\n\n\t\tif ( this.hasPluggable() && this.refObj.pluggable.loaded ) {\n\t\t\tmetaText = this.refObj.pluggable._applyModifications( \"content\", metaText );\n\t\t}\n\t}\n\n\tmetaText = stripHTMLTags( metaText );\n\n\treturn metaText.substring( 0, maximumMetaDescriptionLength );\n};\n\n/**\n * Builds an array with all indexes of the keyword.\n *\n * @returns {Array} Array with matches\n */\nSnippetPreview.prototype.getIndexMatches = function() {\n\tvar indexMatches = [];\n\tvar i = 0;\n\n\t// Starts at 0, locates first match of the keyword.\n\tvar match = this.refObj.rawData.text.indexOf(\n\t\tthis.refObj.rawData.keyword,\n\t\ti\n\t);\n\n\t// Runs the loop untill no more indexes are found, and match returns -1.\n\twhile ( match > -1 ) {\n\t\tindexMatches.push( match );\n\n\t\t// Pushes location to indexMatches and increase i with the length of keyword.\n\t\ti = match + this.refObj.rawData.keyword.length;\n\t\tmatch = this.refObj.rawData.text.indexOf(\n\t\t\tthis.refObj.rawData.keyword,\n\t\t\ti\n\t\t);\n\t}\n\treturn indexMatches;\n};\n\n/**\n * Builds an array with indexes of all sentence ends (select on .).\n *\n * @returns {Array} Array with sentences.\n */\nSnippetPreview.prototype.getPeriodMatches = function() {\n\tvar periodMatches = [ 0 ];\n\tvar match;\n\tvar i = 0;\n\twhile ( ( match = this.refObj.rawData.text.indexOf( \".\", i ) ) > -1 ) {\n\t\tperiodMatches.push( match );\n\t\ti = match + 1;\n\t}\n\treturn periodMatches;\n};\n\n/**\n * Formats the keyword for use in the snippetPreview by adding <strong>-tags\n * strips unwanted characters that could break the regex or give unwanted results.\n *\n * @param {string} textString The keyword string that needs to be formatted.\n *\n * @returns {string} The formatted keyword.\n */\nSnippetPreview.prototype.formatKeyword = function( textString ) {\n\t// Removes characters from the keyword that could break the regex, or give unwanted results.\n\tvar keyword = this.refObj.rawData.keyword;\n\n\t// Match keyword case-insensitively.\n\tvar keywordRegex = createWordRegex( keyword, \"\", false );\n\n\ttextString = textString.replace( keywordRegex, function( str ) {\n\t\treturn \"<strong>\" + str + \"</strong>\";\n\t} );\n\n\t// Transliterate the keyword for highlighting\n\tvar transliterateKeyword = transliterate( keyword, this.refObj.rawData.locale );\n\tif ( transliterateKeyword !== keyword ) {\n\t\tkeywordRegex = createWordRegex( transliterateKeyword, \"\", false );\n\t\ttextString = textString.replace( keywordRegex, function( str ) {\n\t\t\treturn \"<strong>\" + str + \"</strong>\";\n\t\t} );\n\t}\n\treturn textString;\n};\n\n/**\n * Formats the keyword for use in the URL by accepting - and _ instead of spaces and by adding <strong>-tags.\n * Strips unwanted characters that could break the regex or give unwanted results.\n *\n * @param {string} textString The keyword string that needs to be formatted.\n *\n * @returns {XML|string|void} The formatted keyword string to be used in the URL.\n */\nSnippetPreview.prototype.formatKeywordUrl = function( textString ) {\n\tvar keyword = this.refObj.rawData.keyword;\n\tkeyword = transliterate( keyword, this.refObj.rawData.locale );\n\tkeyword = keyword.replace( /'/, \"\" );\n\n\tvar dashedKeyword = keyword.replace( /\\s/g, \"-\" );\n\n\t// Match keyword case-insensitively.\n\tvar keywordRegex = createWordRegex( dashedKeyword, \"\\\\-\" );\n\n\t// Make the keyword bold in the textString.\n\treturn textString.replace( keywordRegex, function( str ) {\n\t\treturn \"<strong>\" + str + \"</strong>\";\n\t} );\n};\n\n/**\n * Renders the outputs to the elements on the page.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.renderOutput = function() {\n\tthis.element.rendered.title.innerHTML = this.output.title;\n\tthis.element.rendered.urlPath.innerHTML = this.output.cite;\n\tthis.element.rendered.urlBase.innerHTML = this.output.url;\n\tthis.element.rendered.metaDesc.innerHTML = this.output.meta;\n};\n\n/**\n * Makes the rendered meta description gray if no meta description has been set by the user.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.renderSnippetStyle = function() {\n\tvar metaDescElement = this.element.rendered.metaDesc;\n\tvar metaDesc = getAnalyzerMetaDesc.call( this );\n\n\tif ( isEmpty( metaDesc ) ) {\n\t\tdomManipulation.addClass( metaDescElement, \"desc-render\" );\n\t\tdomManipulation.removeClass( metaDescElement, \"desc-default\" );\n\t} else {\n\t\tdomManipulation.addClass( metaDescElement, \"desc-default\" );\n\t\tdomManipulation.removeClass( metaDescElement, \"desc-render\" );\n\t}\n};\n\n/**\n * Function to call init, to rerender the Snippet Preview.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.reRender = function() {\n\tthis.init();\n};\n\n/**\n * Checks text length of the snippetmeta and snippet title, shortens it if it is too long.\n * @param {Object} event The event to check the text length from.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.checkTextLength = function( event ) {\n\tvar text = event.currentTarget.textContent;\n\tswitch ( event.currentTarget.id ) {\n\t\tcase \"snippet_meta\":\n\t\t\tevent.currentTarget.className = \"desc\";\n\t\t\tif ( text.length > maximumMetaDescriptionLength ) {\n\t\t\t\t/* eslint-disable */\n\t\t\t\tYoastSEO.app.snippetPreview.unformattedText.snippet_meta = event.currentTarget.textContent;\n\t\t\t\t/* eslint-enable */\n\t\t\t\tevent.currentTarget.textContent = text.substring(\n\t\t\t\t\t0,\n\t\t\t\t\tmaximumMetaDescriptionLength\n\t\t\t\t);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"snippet_title\":\n\t\t\tevent.currentTarget.className = \"title\";\n\t\t\tif ( text.length > titleMaxLength ) {\n\t\t\t\t/* eslint-disable */\n\t\t\t\tYoastSEO.app.snippetPreview.unformattedText.snippet_title = event.currentTarget.textContent;\n\t\t\t\t/* eslint-enable */\n\t\t\t\tevent.currentTarget.textContent = text.substring( 0, titleMaxLength );\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n};\n\n/**\n * Get the unformatted text.\n *\n * When clicking on an element in the Snippet Preview, this checks and fills the textContent with the data from the\n * unformatted text. This removes the keyword highlighting and modified data so the original content can be editted.\n *\n * @param {Object} event The event to get the unformatted text from.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.getUnformattedText = function( event ) {\n\tvar currentElement = event.currentTarget.id;\n\tif ( typeof this.unformattedText[ currentElement ] !== \"undefined\" ) {\n\t\tevent.currentTarget.textContent = this.unformattedText[ currentElement ];\n\t}\n};\n\n/**\n * Sets the unformatted text.\n *\n * When text is entered into the snippetPreview elements, the text is set in the unformattedText object.\n * This allows the visible data to be editted in the snippetPreview.\n *\n * @param {Object} event The event to set the unformatted text from.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setUnformattedText = function( event ) {\n\tvar elem =  event.currentTarget.id;\n\tthis.unformattedText[ elem ] = document.getElementById( elem ).textContent;\n};\n\n/**\n * Validates all fields and highlights errors.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.validateFields = function() {\n\tvar metaDescription = getAnalyzerMetaDesc.call( this );\n\tvar title = getAnalyzerTitle.call( this );\n\n\tif ( metaDescription.length > maximumMetaDescriptionLength ) {\n\t\tdomManipulation.addClass( this.element.input.metaDesc, \"snippet-editor__field--invalid\" );\n\t} else {\n\t\tdomManipulation.removeClass( this.element.input.metaDesc, \"snippet-editor__field--invalid\" );\n\t}\n\n\tif ( title.length > titleMaxLength ) {\n\t\tdomManipulation.addClass( this.element.input.title, \"snippet-editor__field--invalid\" );\n\t} else {\n\t\tdomManipulation.removeClass( this.element.input.title, \"snippet-editor__field--invalid\" );\n\t}\n};\n\n/**\n * Updates progress bars based on the available data.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.updateProgressBars = function() {\n\tvar metaDescriptionRating, titleRating, metaDescription;\n\n\tmetaDescription = getAnalyzerMetaDesc.call( this );\n\n\ttitleRating = rateTitleLength( this.data.titleWidth );\n\tmetaDescriptionRating = rateMetaDescLength( metaDescription.length );\n\n\tupdateProgressBar.call(\n\t\tthis,\n\t\tthis.element.progress.title,\n\t\tthis.data.titleWidth,\n\t\ttitleMaxLength,\n\t\ttitleRating\n\t);\n\n\tupdateProgressBar.call(\n\t\tthis,\n\t\tthis.element.progress.metaDesc,\n\t\tmetaDescription.length,\n\t\tmaximumMetaDescriptionLength,\n\t\tmetaDescriptionRating\n\t);\n};\n\n/**\n * Gets the width of the Snippet Preview to set its initial view to desktop or mobile.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setInitialView = function() {\n\tvar previewWidth = document.getElementById( \"snippet_preview\" ).getBoundingClientRect().width;\n\tthis.snippetPreviewToggle.setVisibility( previewWidth );\n};\n\n/**\n * When the window is resized, gets the width of the Snippet Preview to set the Scroll Hint visibility.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.handleWindowResizing = debounce( function() {\n\tvar previewWidth = document.getElementById( \"snippet_preview\" ).getBoundingClientRect().width;\n\tthis.snippetPreviewToggle.setScrollHintVisibility( previewWidth );\n}, 25 );\n\n/**\n * Binds the reloadSnippetText function to the blur of the snippet inputs.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.bindEvents = function() {\n\tvar targetElement,\n\t\telems = [ \"title\", \"slug\", \"meta-description\" ];\n\n\tforEach( elems, function( elem ) {\n\t\ttargetElement = document.getElementsByClassName( \"js-snippet-editor-\" + elem )[ 0 ];\n\n\t\ttargetElement.addEventListener( \"keydown\", this.changedInput.bind( this ) );\n\t\ttargetElement.addEventListener( \"keyup\", this.changedInput.bind( this ) );\n\n\t\ttargetElement.addEventListener( \"input\", this.changedInput.bind( this ) );\n\t\ttargetElement.addEventListener( \"focus\", this.changedInput.bind( this ) );\n\t\ttargetElement.addEventListener( \"blur\", this.changedInput.bind( this ) );\n\t}.bind( this ) );\n\n\tthis.element.editToggle.addEventListener( \"click\", this.toggleEditor.bind( this ) );\n\tthis.element.closeEditor.addEventListener( \"click\", this.closeEditor.bind( this ) );\n\n\t// Note: `handleWindowResizing` is called also in Yoast SEO when the WP admin menu state changes.\n\twindow.addEventListener( \"resize\", this.handleWindowResizing.bind( this ) );\n\n\t// Loop through the bindings and bind a click handler to the click to focus the focus element.\n\tforEach( inputPreviewBindings, function( binding ) {\n\t\tvar previewElement = document.getElementById( binding.preview );\n\t\tvar inputElement = this.element.input[ binding.inputField ];\n\n\t\t// Make the preview element click open the editor and focus the correct input.\n\t\tpreviewElement.addEventListener( \"click\", function() {\n\t\t\tthis.openEditor();\n\t\t\tinputElement.focus();\n\t\t}.bind( this ) );\n\n\t\t// Make focusing an input, update the carets.\n\t\tinputElement.addEventListener( \"focus\", function() {\n\t\t\tthis._currentFocus = binding.inputField;\n\n\t\t\tthis._updateFocusCarets();\n\t\t}.bind( this ) );\n\n\t\t// Make removing focus from an element, update the carets.\n\t\tinputElement.addEventListener( \"blur\", function() {\n\t\t\tthis._currentFocus = null;\n\n\t\t\tthis._updateFocusCarets();\n\t\t}.bind( this ) );\n\n\t\tpreviewElement.addEventListener( \"mouseover\", function() {\n\t\t\tthis._currentHover = binding.inputField;\n\n\t\t\tthis._updateHoverCarets();\n\t\t}.bind( this ) );\n\n\t\tpreviewElement.addEventListener( \"mouseout\", function() {\n\t\t\tthis._currentHover = null;\n\n\t\t\tthis._updateHoverCarets();\n\t\t}.bind( this ) );\n\t}.bind( this ) );\n};\n\n/**\n * Updates Snippet Preview on changed input. It's debounced so that we can call this function as much as we want.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.changedInput = debounce( function() {\n\tthis.updateDataFromDOM();\n\tthis.validateFields();\n\tthis.updateProgressBars();\n\n\tthis.refresh();\n\n\tif ( this.hasApp() ) {\n\t\tthis.refObj.refresh();\n\t}\n}, 25 );\n\n/**\n * Updates our data object from the DOM.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.updateDataFromDOM = function() {\n\tthis.data.title = this.element.input.title.value;\n\tthis.data.urlPath = this.element.input.urlPath.value;\n\tthis.data.metaDesc = this.element.input.metaDesc.value;\n\n\t// Clone so the data isn't changeable.\n\tthis.opts.callbacks.saveSnippetData( clone( this.data ) );\n};\n\n/**\n * Opens the snippet editor.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.openEditor = function() {\n\tthis.element.editToggle.setAttribute( \"aria-expanded\", \"true\" );\n\n\t// Show these elements.\n\tdomManipulation.removeClass( this.element.formContainer, \"snippet-editor--hidden\" );\n\n\tthis.opened = true;\n};\n\n/**\n * Closes the snippet editor.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.closeEditor = function() {\n\t// Hide these elements.\n\tdomManipulation.addClass( this.element.formContainer, \"snippet-editor--hidden\" );\n\n\tthis.element.editToggle.setAttribute( \"aria-expanded\", \"false\" );\n\tthis.element.editToggle.focus();\n\n\tthis.opened = false;\n};\n\n/**\n * Toggles the snippet editor.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.toggleEditor = function() {\n\tif ( this.opened ) {\n\t\tthis.closeEditor();\n\t} else {\n\t\tthis.openEditor();\n\t}\n};\n\n/**\n * Updates carets before the preview and input fields.\n *\n * @private\n *\n * @returns {void}\n */\nSnippetPreview.prototype._updateFocusCarets = function() {\n\tvar focusedLabel, focusedPreview;\n\n\t// Disable all carets on the labels.\n\tforEach( this.element.label, function( element ) {\n\t\tdomManipulation.removeClass( element, \"snippet-editor__label--focus\" );\n\t} );\n\n\t// Disable all carets on the previews.\n\tforEach( this.element.preview, function( element ) {\n\t\tdomManipulation.removeClass( element, \"snippet-editor__container--focus\" );\n\t} );\n\n\tif ( null !== this._currentFocus ) {\n\t\tfocusedLabel = this.element.label[ this._currentFocus ];\n\t\tfocusedPreview = this.element.preview[ this._currentFocus ];\n\n\t\tdomManipulation.addClass( focusedLabel, \"snippet-editor__label--focus\" );\n\t\tdomManipulation.addClass( focusedPreview, \"snippet-editor__container--focus\" );\n\t}\n};\n\n/**\n * Updates hover carets before the input fields.\n *\n * @private\n *\n * @returns {void}\n */\nSnippetPreview.prototype._updateHoverCarets = function() {\n\tvar hoveredLabel;\n\n\tforEach( this.element.label, function( element ) {\n\t\tdomManipulation.removeClass( element, \"snippet-editor__label--hover\" );\n\t} );\n\n\tif ( null !== this._currentHover ) {\n\t\thoveredLabel = this.element.label[ this._currentHover ];\n\n\t\tdomManipulation.addClass( hoveredLabel, \"snippet-editor__label--hover\" );\n\t}\n};\n\n/**\n * Updates the title data and the title input field. This also means the snippet editor view is updated.\n *\n * @param {string} title The title to use in the input field.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setTitle = function( title ) {\n\tthis.element.input.title.value = title;\n\n\tthis.changedInput();\n};\n\n/**\n * Updates the url path data and the url path input field. This also means the snippet editor view is updated.\n *\n * @param {string} urlPath the URL path to use in the input field.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setUrlPath = function( urlPath ) {\n\tthis.element.input.urlPath.value = urlPath;\n\n\tthis.changedInput();\n};\n\n/**\n * Updates the meta description data and the meta description input field. This also means the snippet editor view is updated.\n *\n * @param {string} metaDesc the meta description to use in the input field.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setMetaDescription = function( metaDesc ) {\n\tthis.element.input.metaDesc.value = metaDesc;\n\n\tthis.changedInput();\n};\n\n/**\n * Creates elements with the purpose to calculate the sizes of elements and puts these elements to the body.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.createMeasurementElements = function() {\n\tvar metaDescriptionElement, spanHolder;\n\tmetaDescriptionElement = hiddenElement(\n\t\t{\n\t\t\twidth: document.getElementById( \"meta_container\" ).offsetWidth + \"px\",\n\t\t\twhiteSpace: \"\",\n\t\t}\n\t);\n\n\tspanHolder = document.createElement( \"div\" );\n\tspanHolder.className = \"yoast-measurement-elements-holder\";\n\n\tspanHolder.innerHTML = metaDescriptionElement;\n\n\tdocument.body.appendChild( spanHolder );\n\n\tthis.element.measurers.metaHeight = spanHolder.childNodes[ 0 ];\n};\n\n/**\n * Copies the title text to the title measure element to calculate the width in pixels.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.measureTitle = function() {\n\tif ( this.element.rendered.title.offsetWidth !== 0 || this.element.rendered.title.textContent === \"\" ) {\n\t\tthis.data.titleWidth = this.element.rendered.title.offsetWidth;\n\t}\n};\n\n/**\n * Copies the metadescription text to the metadescription measure element to calculate the height in pixels.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.measureMetaDescription = function() {\n\tvar metaHeightElement = this.element.measurers.metaHeight;\n\n\tmetaHeightElement.innerHTML = this.element.rendered.metaDesc.innerHTML;\n\n\tthis.data.metaHeight = metaHeightElement.offsetHeight;\n};\n\n/**\n * Returns the width of the title in pixels.\n *\n * @returns {Number} The width of the title in pixels.\n */\nSnippetPreview.prototype.getTitleWidth = function() {\n\treturn this.data.titleWidth;\n};\n\n/**\n * Allows to manually set the title width.\n *\n * This may be useful in setups where the title field will not always be rendered.\n *\n * @param {Number} titleWidth The width of the title in pixels.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setTitleWidth = function( titleWidth ) {\n\tthis.data.titleWidth = titleWidth;\n};\n\n/**\n * Returns whether or not an app object is present.\n *\n * @returns {boolean} Whether or not there is an App object present.\n */\nSnippetPreview.prototype.hasApp = function() {\n\treturn ! isUndefined( this.refObj );\n};\n\n/**\n * Returns whether or not a pluggable object is present.\n *\n * @returns {boolean} Whether or not there is a Pluggable object present.\n */\nSnippetPreview.prototype.hasPluggable = function() {\n\treturn ! isUndefined( this.refObj ) && ! isUndefined( this.refObj.pluggable );\n};\n\n/* eslint-disable */\n\n/**\n * Disables Enter as input.\n *\n * Used to disable enter as input. Returns false to prevent enter, and preventDefault and\n * cancelBubble to prevent other elements from capturing this event.\n *\n * @deprecated\n *\n * @param {KeyboardEvent} ev The keyboard event.\n */\nSnippetPreview.prototype.disableEnter = function( ev ) {};\n\n/**\n * Adds and removes the tooLong class when a text is too long.\n *\n * @deprecated\n * @param ev The event.\n */\nSnippetPreview.prototype.textFeedback = function( ev ) {};\n\n/**\n * Shows the edit icon corresponding to the hovered element.\n *\n * @deprecated\n *\n * @param ev The event.\n */\nSnippetPreview.prototype.showEditIcon = function( ev ) {\n\n};\n\n/**\n * Removes all editIcon-classes, sets to snippet_container.\n *\n * @deprecated\n */\nSnippetPreview.prototype.hideEditIcon = function() {};\n\n/**\n * Sets focus on child element of the snippet_container that is clicked. Hides the editicon.\n *\n * @deprecated\n *\n * @param ev The event.\n */\nSnippetPreview.prototype.setFocus = function( ev ) {};\n\n/* eslint-disable */\nexport default SnippetPreview;\n"]}