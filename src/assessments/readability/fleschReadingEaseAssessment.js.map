{"version":3,"sources":["../../../../src/assessments/readability/fleschReadingEaseAssessment.js"],"names":["availableLanguages","FleschReadingEaseAssessment","config","defaultConfig","urlTitle","urlCallToAction","identifier","_config","paper","researcher","i18n","fleschReadingResult","getResearch","isApplicable","assessmentResult","calculatedResult","calculateResult","setScore","score","setText","resultText","text","dgettext","noteGoodJob","borders","veryEasy","feedback","scores","sprintf","easy","fairlyEasy","okay","fairlyDifficult","note","difficult","veryDifficult","isLanguageAvailable","getLocale","hasText"],"mappings":"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","file":"fleschReadingEaseAssessment.js","sourcesContent":["import { inRange, merge } from \"lodash-es\";\n\nimport Assessment from \"../../assessment\";\nimport getLanguageAvailability from \"../../helpers/getLanguageAvailability\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\nconst availableLanguages = [ \"en\", \"nl\", \"de\", \"it\", \"ru\", \"fr\", \"es\" ];\n\nclass FleschReadingEaseAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} config The configuration to use.\n\t * @returns {void}\n\t */\n\tconstructor( config ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/34r\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/34s\" ),\n\t\t};\n\n\t\tthis.identifier = \"fleschReadingEase\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * The assessment that runs the FleschReading on the paper.\n\t *\n\t * @param {Object} paper The paper to run this assessment on.\n\t * @param {Object} researcher The researcher used for the assessment.\n\t * @param {Object} i18n The i18n-object used for parsing translations.\n\t *\n\t * @returns {Object} An assessmentResult with the score and formatted text.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tthis.fleschReadingResult = researcher.getResearch( \"calculateFleschReading\" );\n\t\tif ( this.isApplicable( paper ) ) {\n\t\t\tconst assessmentResult =  new AssessmentResult( i18n );\n\t\t\tconst calculatedResult = this.calculateResult( i18n );\n\t\t\tassessmentResult.setScore( calculatedResult.score );\n\t\t\tassessmentResult.setText( calculatedResult.resultText );\n\n\t\t\treturn assessmentResult;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Calculates the assessment result based on the fleschReadingScore.\n\t *\n\t * @param {Object} i18n The i18n-object used for parsing translations.\n\t *\n\t * @returns {Object} Object with score and resultText.\n\t */\n\tcalculateResult( i18n ) {\n\t\t// Results must be between 0 and 100;\n\t\tif ( this.fleschReadingResult < 0 ) {\n\t\t\tthis.fleschReadingResult = 0;\n\t\t}\n\n\t\tif ( this.fleschReadingResult > 100 ) {\n\t\t\tthis.fleschReadingResult = 100;\n\t\t}\n\n\t\t/* Translators: %1$s and %5$s expand to a link on yoast.com,\n\t\t%2$s to the anchor end tag,\n\t\t%7$s expands to the anchor end tag and a full stop,\n\t\t%3$s expands to the numeric Flesch reading ease score,\n\t\t%4$s to the easiness of reading,\n\t\t%6$s expands to a call to action based on the score */\n\t\tconst text = i18n.dgettext(\n\t\t\t\"js-text-analysis\",\n\t\t\t\"%1$sFlesch Reading Ease%2$s: The copy scores %3$s in the test, which is considered %4$s to read. %5$s%6$s%7$s\"\n\t\t);\n\t\tconst noteGoodJob = i18n.dgettext( \"js-text-analysis\", \"Good job!\" );\n\n\t\tif ( this.fleschReadingResult > this._config.borders.veryEasy ) {\n\t\t\tconst feedback = i18n.dgettext( \"js-text-analysis\", \"very easy\" );\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.veryEasy,\n\t\t\t\tresultText: i18n.sprintf( text, this._config.urlTitle, \"</a>\", this.fleschReadingResult, feedback, \"\", noteGoodJob, \"\" ),\n\t\t\t};\n\t\t}\n\n\t\tif ( inRange( this.fleschReadingResult, this._config.borders.easy, this._config.borders.veryEasy ) ) {\n\t\t\tconst feedback = i18n.dgettext( \"js-text-analysis\", \"easy\" );\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.easy,\n\t\t\t\tresultText: i18n.sprintf( text, this._config.urlTitle, \"</a>\", this.fleschReadingResult, feedback, \"\", noteGoodJob, \"\" ),\n\t\t\t};\n\t\t}\n\n\t\tif ( inRange( this.fleschReadingResult, this._config.borders.fairlyEasy, this._config.borders.easy ) ) {\n\t\t\tconst feedback = i18n.dgettext( \"js-text-analysis\", \"fairly easy\" );\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.fairlyEasy,\n\t\t\t\tresultText: i18n.sprintf( text, this._config.urlTitle, \"</a>\", this.fleschReadingResult, feedback, \"\", noteGoodJob, \"\" ),\n\t\t\t};\n\t\t}\n\n\t\tif ( inRange( this.fleschReadingResult, this._config.borders.okay, this._config.borders.fairlyEasy ) ) {\n\t\t\tconst feedback = i18n.dgettext( \"js-text-analysis\", \"ok\" );\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.okay,\n\t\t\t\tresultText: i18n.sprintf( text, this._config.urlTitle, \"</a>\", this.fleschReadingResult, feedback, \"\", noteGoodJob, \"\" ),\n\t\t\t};\n\t\t}\n\n\t\tif ( inRange( this.fleschReadingResult, this._config.borders.fairlyDifficult, this._config.borders.okay ) ) {\n\t\t\tconst feedback = i18n.dgettext( \"js-text-analysis\", \"fairly difficult\" );\n\t\t\tconst note = i18n.dgettext( \"js-text-analysis\", \"Try to make shorter sentences to improve readability\" );\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.fairlyDifficult,\n\t\t\t\tresultText: i18n.sprintf( text, this._config.urlTitle, \"</a>\", this.fleschReadingResult, feedback,\n\t\t\t\t\tthis._config.urlCallToAction, note, \"</a>.\"  ),\n\t\t\t};\n\t\t}\n\n\t\tif ( inRange( this.fleschReadingResult, this._config.borders.difficult, this._config.borders.fairlyDifficult ) ) {\n\t\t\tconst feedback = i18n.dgettext( \"js-text-analysis\", \"difficult\" );\n\t\t\tconst note = i18n.dgettext( \"js-text-analysis\", \"Try to make shorter sentences, using less difficult words to improve readability\" );\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.difficult,\n\t\t\t\tresultText: i18n.sprintf( text, this._config.urlTitle, \"</a>\", this.fleschReadingResult, feedback,\n\t\t\t\t\tthis._config.urlCallToAction, note, \"</a>.\" ),\n\t\t\t};\n\t\t}\n\n\t\tconst feedback = i18n.dgettext( \"js-text-analysis\", \"very difficult\" );\n\t\tconst note = i18n.dgettext( \"js-text-analysis\", \"Try to make shorter sentences, using less difficult words to improve readability\" );\n\t\treturn {\n\t\t\tscore: this._config.scores.veryDifficult,\n\t\t\tresultText: i18n.sprintf( text, this._config.urlTitle, \"</a>\", this.fleschReadingResult, feedback,\n\t\t\t\tthis._config.urlCallToAction, note, \"</a>.\" ),\n\t\t};\n\t}\n\n\t/**\n\t * Checks if Flesch reading analysis is available for the language of the paper.\n\t *\n\t * @param {Object} paper The paper to have the Flesch score to be calculated for.\n\t * @returns {boolean} Returns true if the language is available and the paper is not empty.\n\t */\n\tisApplicable( paper ) {\n\t\tconst isLanguageAvailable = getLanguageAvailability( paper.getLocale(), availableLanguages );\n\t\treturn ( isLanguageAvailable && paper.hasText() );\n\t}\n}\n\nexport default FleschReadingEaseAssessment;\n"]}